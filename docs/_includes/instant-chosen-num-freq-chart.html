<div style="height:420px;">
  <canvas id="{{ include.id | default: 'freqChart' }}"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
(function () {
  const raw = {{ site.data.freq | jsonify }};

  // labels: "1"..."100"
  const labels = Array.from({ length: 100 }, (_, i) => String(i + 1));

  // values: 對應 raw["1"]..raw["100"]，缺的補 0
  const values = labels.map((k) => {
    const v = raw && Object.prototype.hasOwnProperty.call(raw, k) ? raw[k] : 0;
    const n = Number(v);
    return Number.isFinite(n) ? n : 0;
  });

  const canvasId = '{{ include.id | default: "freqChart" }}';
  const ctx = document.getElementById(canvasId);

  if (!ctx) {
    console.error("Canvas not found:", canvasId);
    return;
  }

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels,
      datasets: [{
        label: '{{ include.title | default: "1~100 次數分佈" }}',
        data: values,
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: {
          ticks: {
            // 每 5 個顯示一次（5,10,15...100）
            callback: function(_, index) {
              const label = labels[index];
              return (Number(label) % 5 === 0) ? label : '';
            }
          }
        },
        y: {
          beginAtZero: true,
          title: { display: true, text: '次數' }
        }
      }
    }
  });
})();
</script>
